<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <view class="page-title">{{pageTitle || 'è”¬æœç”Ÿé²œ'}}</view>
  </view>

  <!-- åˆ†ç±»å¯¼èˆª - å¸¦å›¾æ ‡çš„ç‰ˆæœ¬ -->
  <view class="category-nav" wx:if="{{showCategoryIcons}}">
    <scroll-view scroll-x="true" class="category-scroll">
      <view class="category-scroll-content">
        <block wx:for="{{categories}}" wx:key="id">
          <view 
            class="category-card {{item.active ? 'active' : ''}}" 
            bindtap="switchCategory" 
            data-category="{{item.name}}"
          >
            <image 
              class="category-icon" 
              src="{{item.icon}}" 
              mode="aspectFit"
              lazy-load="true"
              binderror="handleIconError"
              data-index="{{index}}"
            ></image>
            <view class="category-name">{{item.name}}</view>
          </view>
        </block>
      </view>
    </scroll-view>
  </view>
  
  <!-- åˆ†ç±»å¯¼èˆª - æ–‡å­—ç‰ˆæœ¬ -->
  <view class="category-nav" wx:else>
    <scroll-view scroll-x="true" class="category-scroll">
      <view class="category-scroll-content">
        <block wx:for="{{categories}}" wx:key="id">
          <view 
            class="category-item {{item.active ? 'active' : ''}}" 
            bindtap="switchCategory" 
            data-category="{{item.name}}"
          >
            {{item.name}}
          </view>
        </block>
      </view>
    </scroll-view>
  </view>
  
  <!-- åˆ‡æ¢å›¾æ ‡æŒ‰é’® -->
  <view class="toggle-icons-btn" bindtap="toggleCategoryIcons">
    {{showCategoryIcons ? 'ç®€æ´è§†å›¾' : 'å›¾æ ‡è§†å›¾'}}
  </view>
  
  <!-- æ’åºæ  -->
  <view class="sort-bar">
    <view class="category-info">{{currentCategory === 'å…¨éƒ¨' ? 'å…¨éƒ¨å†œäº§å“' : currentCategory + 'ç±»å†œäº§å“'}}</view>
    <view class="sort-btn" bindtap="showSort">
      <text>{{currentSort}}</text>
      <text class="sort-icon">â–¼</text>
    </view>
    
    <!-- æ’åºé€‰é¡¹å¼¹å‡ºå±‚ -->
    <view class="sort-options {{showSortOptions ? 'show' : ''}}" wx:if="{{showSortOptions}}">
      <view class="sort-mask" bindtap="hideSort"></view>
      <view class="sort-list">
        <block wx:for="{{sortOptions}}" wx:key="id">
          <view 
            class="sort-option {{item.active ? 'active' : ''}}" 
            bindtap="selectSort" 
            data-sort="{{item.name}}"
          >
            {{item.name}}
            <text class="check-icon" wx:if="{{item.active}}">âœ“</text>
          </view>
        </block>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{isLoading}}">
    <view class="loading"></view>
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <!-- äº§å“åˆ—è¡¨ -->
  <view class="product-list" wx:if="{{!isLoading}}">
    <block wx:for="{{products}}" wx:key="id">
      <view class="product-item" bindtap="viewProductDetail" data-id="{{item.id}}">
        <image 
          class="product-image" 
          src="{{item.image}}" 
          mode="aspectFill" 
          lazy-load="true"
          binderror="handleImageError"
          data-index="{{index}}"
        />
        <view class="product-info">
          <view class="product-name">{{item.name}}</view>
          <view class="product-category">{{item.category}}ç±»</view>
          <view class="product-price">
            <view class="price-item">
              <text class="price-label">æ‰¹å‘ä»·ï¼š</text>
              <text class="price-value">Â¥{{item.wholesalePrice}}</text>
              <text class="price-unit">/{{item.unit}}</text>
            </view>
            <view class="price-item">
              <text class="price-label">å¸‚åœºä»·ï¼š</text>
              <text class="price-value market">Â¥{{item.marketPrice}}</text>
              <text class="price-unit">/{{item.unit}}</text>
            </view>
          </view>
          <view class="product-sales">é”€é‡: {{item.sales}}{{item.unit}}</view>
        </view>
        <view class="cart-btn" catchtap="addToCart" data-id="{{item.id}}">
          <text class="cart-icon">+</text>
        </view>
      </view>
    </block>
  </view>
  
  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!isLoading && products.length === 0}}">
    <view class="empty-icon">ğŸ”</view>
    <view class="empty-text">æš‚æ— ç›¸å…³äº§å“</view>
  </view>
  
  <!-- åº•éƒ¨æç¤º -->
  <view class="footer-tip" wx:if="{{!isLoading && products.length > 0}}">
    -- å·²ç»åˆ°åº•å•¦ --
  </view>
</view> 