# 农业应用商家管理后台 - 本地启动指南

## 问题解决方案

我们发现您之前在启动后台服务时遇到了连接问题。根据分析，主要原因是：

1. **数据库连接问题**：无法连接到远程数据库服务器 (175.178.80.222:3307)
2. **数据库驱动不匹配**：应用使用MariaDB驱动，但需要连接MySQL数据库
3. **网络或防火墙问题**：连接超时，无法建立与数据库的连接

为解决这些问题，我们创建了一套完整的本地启动方案，不依赖远程服务器和Docker。

## 本地启动方法（推荐）

### 前提条件

1. 已安装 Node.js (v14或更高版本)
2. 已安装 MySQL (5.7或8.0版本)

### 启动步骤

1. **一键启动**（最简单）：
   双击项目根目录中的 `start-local-backend.bat` 文件
   
   这个脚本会自动：
   - 检查环境是否满足要求
   - 如需要，配置本地MySQL数据库
   - 安装项目依赖
   - 启动后端服务
   - 自动打开浏览器访问管理后台

2. **手动配置数据库**（如需要）：
   如果您想单独配置数据库，可以双击 `setup-local-database.bat`
   
   这个脚本会：
   - 检查MySQL是否已安装
   - 创建agricultural_app数据库
   - 设置基本表结构
   - 创建管理员账户
   - 生成正确的环境配置文件

## 登录信息

成功启动后，您可以使用以下信息登录管理后台：

- 网址：http://localhost:5000/admin
- 用户名：admin
- 密码：admin123

## 常见问题解决

### MySQL未安装或无法访问

如果您尚未安装MySQL，请从以下地址下载并安装：
https://dev.mysql.com/downloads/mysql/

安装后确保：
1. MySQL服务已启动
2. 记住设置的root密码
3. MySQL的bin目录已添加到系统PATH中

### 端口冲突

如果端口5000被占用，您可以修改 `docker-backend/.env` 文件中的 `PORT` 设置。

### 数据库连接问题

如果在启动过程中遇到数据库连接错误：
1. 确认MySQL服务正在运行
2. 确认使用了正确的用户名和密码
3. 尝试重新运行 `setup-local-database.bat` 配置数据库

### 依赖安装失败

如果依赖安装失败，可以手动执行：
```
cd docker-backend
npm config set registry https://registry.npmmirror.com
npm install
```

## 技术说明

本启动方案通过以下修改解决了问题：

1. 将数据库配置从远程MariaDB更改为本地MySQL
2. 增加了数据库连接超时和重试机制
3. 添加了本地数据库配置功能
4. 优化了错误处理和提示信息

这样，您可以在本地环境中完全独立地运行和测试系统，无需依赖远程服务器和复杂的Docker配置。 