<!--天气预报页面-->
<view class="container">
  <!-- 主要天气内容 -->
  <view class="weather-content">
    <!-- 顶部区域 -->
    <view class="header">
      <view class="location" bindtap="showCityPicker">
        <image class="location-icon" src="/images/icons/location.svg" mode="aspectFit"></image>
        <view class="city-name">{{city}}</view>
        <view class="update-time">{{updateTime}} 更新</view>
      </view>
      <view class="refresh {{loading ? 'loading' : ''}}" bindtap="refreshWeather">
        <image src="/images/icons/refresh.svg" mode="aspectFit"></image>
      </view>
    </view>

    <!-- 当前天气 -->
    <view class="current-weather">
      <view class="temp-wrap">
        <text class="temp">{{temperature}}</text>
        <text class="degree">°</text>
      </view>
      <view class="weather-desc">{{weatherDesc}}</view>
      <image class="weather-icon" src="/images/weather/{{weatherIcon}}.svg" mode="aspectFit"></image>
    </view>

    <!-- 天气详情 -->
    <view class="weather-details">
      <view class="detail-item">
        <image src="/images/icons/humidity.svg" mode="aspectFit"></image>
        <text class="label">湿度</text>
        <text class="value">{{humidity}}%</text>
      </view>
      <view class="detail-item">
        <image src="/images/icons/wind.svg" mode="aspectFit"></image>
        <text class="label">风速</text>
        <text class="value">{{windLevel}}级</text>
      </view>
      <view class="detail-item">
        <image src="/images/icons/pressure.svg" mode="aspectFit"></image>
        <text class="label">气压</text>
        <text class="value">{{pressure}}hPa</text>
      </view>
      <view class="detail-item">
        <image src="/images/icons/visibility.svg" mode="aspectFit"></image>
        <text class="label">能见度</text>
        <text class="value">{{visibility}}km</text>
      </view>
    </view>

    <!-- 24小时预报 -->
    <view class="forecast-section">
      <view class="section-title">24小时预报</view>
      <view class="hourly-list">
        <text>00:00 18° 多云</text>
        <text>03:00 17° 多云</text>
        <text>06:00 16° 阴</text>
        <text>09:00 19° 多云</text>
        <text>12:00 22° 晴</text>
      </view>
    </view>

    <!-- 7天预报 -->
    <view class="forecast-section">
      <view class="section-title">7天预报</view>
      <view class="daily-list">
        <text>今天 18°/12° 多云</text>
        <text>明天 20°/13° 晴</text>
        <text>后天 19°/14° 多云</text>
        <text>周五 17°/12° 小雨</text>
        <text>周六 16°/11° 阴</text>
      </view>
    </view>

    <!-- 生活指数 -->
    <view class="forecast-section">
      <view class="section-title">生活指数</view>
      <view class="indices-list">
        <text>穿衣 较舒适</text>
        <text>运动 适宜</text>
        <text>感冒 易发</text>
        <text>空气 良好</text>
      </view>
    </view>

    <!-- 农业气象 -->
    <view class="forecast-section">
      <view class="section-title">农业气象</view>
      <view class="agro-list">
        <text>今日气温适宜，建议农户适时进行春耕备耕工作</text>
      </view>
    </view>
  </view>

  <!-- 加载中遮罩 -->
  <view class="loading-mask" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text>加载中...</text>
  </view>

  <!-- 网络错误提示 -->
  <view class="error-mask" wx:if="{{error}}">
    <image src="/images/temp/panda.webp" mode="aspectFit"></image>
    <text class="error-title">{{error.title}}</text>
    <text class="error-desc">{{error.message}}</text>
    <button class="retry-btn" bindtap="refreshWeather">重试</button>
  </view>

  <!-- 城市选择器组件 -->
  <city-picker 
    show="{{showCityPicker}}"
    bind:citySelect="handleCitySelect"
    bind:close="hideCityPicker">
  </city-picker>
</view> 